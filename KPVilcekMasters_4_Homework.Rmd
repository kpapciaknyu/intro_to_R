---
title: "Masters Homework 4"
author: "Katie Papciak"
date: "7/30/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Use the Synthetic Mass Data:

1. Make a subset of Patient data to have patient ID, sex/gender, race and ethnicity. 

```{r}
patients <- read.csv("/Users/kpapciak/Desktop/Katie Programming Folder/patients.csv") #couldnt pull from permalink for some reason so I downloaded file
patients_subset <- cbind.data.frame(patients$Id, patients$GENDER, patients$RACE, patients$ETHNICITY)
```

2. Make a subset of observation data for body weight and body height, and filter to have only the most recent of each. 

```{r}
library(dplyr)
observations <- read.csv("/Users/kpapciak/Desktop/Katie Programming Folder/observations.csv")
obs_filtered <- observations %>% filter(DESCRIPTION %in% c("Body Height", "Body Weight") & DATE >= as.Date("2015-01-01"))
most_recent_obs <- obs_filtered %>% group_by(PATIENT, DESCRIPTION) %>% filter(DATE == max(DATE)) %>% ungroup()

```

3. Convert the body weight and height tables to wide format. 

```{r}
#double check this
library(tidyr)
most_recent_obs_wide <- most_recent_obs %>% select(PATIENT, DESCRIPTION, VALUE) %>% pivot_wider(names_from = DESCRIPTION, values_from = VALUE)
```

4. Merge the body weight and height information onto your demographic dataframe created in question one. 

```{r}
merged_subset<-merge(patients_subset, most_recent_obs_wide, all = T)
```

5. Calculate BMI into a new column. The equation is weight (kg)/height ^2 (m)

```{r}
merged_subset$BMI <- merged_subset$`Body Weight`/(merged_subset$`Body Height`^ 2)
```




6. Why would one use a visualization for exploratory analysis?

Visualizing data before analysis can show the shape, center, and spread of the data to give insight on which techniques one would use to analyze.

7. What information about the nature of our data can a histogram tell us?

Histograms show the shape/distribution of the data.

8. Make a histogram on LEAD from the nyc data frame. Is it skewed? Which way? 

```{r}
nyc <- read.csv("https://raw.githubusercontent.com/fredlapolla/RVilcekMaster23/master/NYC_HANES_DIAB.csv")
hist(nyc$LEAD)
# These observations are skewed to the right.
```

>- Make a QQPlot to assess the normality UCREATININE. Is the distribution normal? How can you tell?

```{r}
library(ggplot2)
qqplot <- ggplot(nyc, aes(sample = UCREATININE)) +
  stat_qq() +
  stat_qq_line() +
  ggtitle("Q-Q Plot of UCREATININE") +
  xlab("Theoretical Quantiles") +
  ylab("Sample Quantiles")
print(qqplot)

#There is a slight right skewness distribution of the data
```

>- Make a boxplot glucose levels by diabetes diagnosis:

```{r}
boxplot(nyc$GLUCOSE,nyc$DX_DBTS)
```

>- Make a scatterplot of total cholesterol by LDL. Does there appear to be a relationship?

```{r}
plot(nyc$CHOLESTEROLTOTAL~nyc$LDLESTIMATE)
#There appears to be a moderately strong positive correlation between total cholesterol and LDL
```


