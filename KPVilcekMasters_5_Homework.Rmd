---
title: "Masters Homework 5"
author: "Katie Papciak"
date: "8/12/2024"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

 

Pull in this data, https://raw.githubusercontent.com/fredlapolla/VilcekSummerDataAnalysis2024/master/elife-32032-fig2-data1_CSV.csv, which is from this paper:

Piechura JR, Amarnath K, O'Shea EK. Natural changes in light interact with circadian regulation at promoters to control gene expression in cyanobacteria. Elife. 2017 Dec 14;6:e32032. doi: 10.7554/eLife.32032. PMID: 29239721; PMCID: PMC5785211.

Make a heatmap of the pearson's R correlation of genes that are expressed such that the rowSums are greater than 100. 

```{r}
if (!requireNamespace("ComplexHeatmap", quietly = TRUE)) {
  BiocManager::install("ComplexHeatmap")
}
library(ComplexHeatmap)
library(ggplot2)
```

```{r}
gene_exp_data<-read.csv("https://raw.githubusercontent.com/fredlapolla/VilcekSummerDataAnalysis2024/master/elife-32032-fig2-data1_CSV.csv")
gene_exp_data <- gene_exp_data[, sapply(gene_exp_data, is.numeric)]
gene_exp_filtered <- gene_exp_data[rowSums(gene_exp_data) > 100, ]
gene_exp_filtered <- gene_exp_filtered[complete.cases(gene_exp_filtered), ]
print(dim(gene_exp_filtered))
Heatmap(as.matrix(gene_exp_filtered), 
        cluster_columns = F, 
        clustering_distance_rows = "euclidean",
        clustering_method_rows = "complete", 
        show_row_names = F,
        name = "Expression",
        column_title = "Samples",
        row_title = "Genes")
```



```{r}
nyc <- read.csv("https://raw.githubusercontent.com/fredlapolla/VilcekSummerDataAnalysis2024/main/NYC_HANES_DIAB.csv")
```



>- Using GGplot, make a boxplot of A1C by diabetes diagnosis. Would you assume the three groups have the same A1C level? 

```{r}
ggplot(nyc, aes(x = factor(DX_DBTS), y = A1C)) + 
  geom_boxplot() +
  stat_summary(fun = "mean", geom = "point", shape = 8, size = 2, color = "white") +
  labs(title = "Boxplot of A1C by Diabetes Diagnosis",
       x = "Diabetes Diagnosis",
       y = "A1C") +
  theme_minimal()
# I would assume the pre-diabetes and diabetes diagnosed groups have higher A1C mean values given that A1C measurement is strongly positively correlated to development of diabetes.
```


>- Use ggplot2 to make a scatter plot of A1C by glucose levels.

```{r}

```


>- Add coloration by gender for the above scatter plot and change the background theme to the minimal option. Change the X axis to label numbers by increments of 3. 

```{r}

```

>- Create a GGPlot chart of Lead vs. Cotinine and show two different themes for the background. 

```{r}

```

>- Make bar charts of mean Glucose level by diabetes diagnosis. Add error bars.

```{r}

```


>- Where could you go to look up other Geom shapes for different types of charts?


